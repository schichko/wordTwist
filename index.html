<!doctype html>
<html>
<header><title>Word Twist!</title></header>    
<script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
<body id="body1">
    <style>
            div.a{
                text-align: center;
            }
    </style>

    <div class="a">
            <h1>Welcome to Wordtwist!</h1>
      
            Please Enter your favorite Color : <input type = "color" id="favColor" >
            <p></p>
    <div class="a">
    Please Enter your Name: <input type="text" id="name">
    <p></p>

    <button onclick="randomRackGenerator()">
            Random Rack
    </button>

    <h2 id = "Rack">...</h2>

 
    <p></p>
    <button onclick="checkRack()">Check</button>

    Please Enter your guess: <input type="text" id="guess">
    <p></p>
    
    <h3 id = "correct_count">Correct Guesses</h3>
    <h2 id = "correct"></h2>

    <h3 id = "length"></h3>
    <!-- <ul id = "correct-answers">
        
    </ul> -->
    <div class="a">
        <iframe src="https://open.spotify.com/embed/album/1yfJqxKKXG320vhqLfUEeC" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
    </div class = "a">

    <script>
        var rackSize = 0;
        var count_of_Correct = 0;
        var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        var charactersLength = characters.length;
        var result = new Array(7);
        var resultString = "";
        var wordList = new Array();
        //var wordLength = new Array(7);
        var correctGuessList = [0,0,0,0,0,0,0];

        var randomRackGenerator = function (evt){
            
            for ( var i = 0; i < 7; i++ ) {
                result[i] = characters.charAt(Math.floor(Math.random() * charactersLength));
            }
            console.log(JSON.stringify(result));
            result.sort();
            console.log(JSON.stringify(result));
        
            resultString =result.join('');
            console.log(resultString);
            //resultString = resultString.substring(0, resultString.length).replace(",","")
            console.log(resultString);
            document.getElementById("Rack").innerText = result;

            /*$.ajax({
                    method: "GET",
                    url: "api.php",
                    data: { "receiver":resultString},
                    success: data=>{ wordList = data}
            }); */
            
            $.ajax({
                method: "GET",
                url: "api.php",
                data: { "receiver": resultString},
                success : function(data) {
                    handleData(data);
                }
            })
        }

        var handleData = function(data) {
            //document.getElementById("correct-answers").innerHTML = "";
            wordList = handleDuplicates(data);
            console.log(data);
            console.log("in handle data");
            // Create list elements for each word
            wordList.forEach( function(word) {
                console.log(word);
                var li = document.createElement('li');
                li.innerHTML = word;
                li.style.listStyle ="none";
                li.style.visibility="hidden";
                li.setAttribute("id", word);
                // document.getElementById("correct-answers").append(li);
                // document.getElementById("correct-answers").append("   Word Size = " + word.length);
                
                correctGuessList[word.length] = correctGuessList[word.length] +1;
                document.getElementById("length").innerText = correctGuessList;
            });
        }
        
        // Used to delete duplicates in the array.
        var handleDuplicates = function(data) {
            let newArray = [];
            data.forEach( function(word){
                if(!newArray.includes(word)){
                    newArray.push(word)
                }
            })
            return newArray;
        }
        
        var checkRack = function (evt){
            var fee = document.getElementById("guess").value;
            fee = fee.toUpperCase();
            if(wordList.includes(fee,0) && correctGuessList.includes(fee,0) == 0){
                correctGuessList.push(fee);
               // document.getElementById(fee).style.visibility = "visible";
                document.getElementById("correct").innerText = correctGuessList;
                count_of_Correct ++;
                document.getElementById("correct_count").innerText = "Correct Guesses: " + count_of_Correct;
            }
            
        }

        var changeColorHandler = function (evt){
            console.log(evt.currentTarget.value);
            let mycolor = evt.currentTarget.value
            document.getElementById("body1").style.backgroundColor = mycolor;
        }

        document.querySelector("#favColor").addEventListener(
            "change",
            changeColorHandler
        )
        
        

    </script>

</body>
</html>